<!DOCTYPE html>
<html>
<head>
    <title>calculation</title>
    <link rel="stylesheet" href="site1.css">
    <script>
        let tg = 0, tw = 0, tb = 0;
        let a = 0, b = 0, gsb = 0, wet = 0, bt = 0;
        let man_gsb_cost = 0, man_wet_cost = 0, man_bt_cost = 0;

        // Load external content
        fetch("home.html")
            .then(response => response.text())
            .then(data => {
                document.getElementById("home").innerHTML = data;
            });

        fetch("contact.html")
            .then(response => response.text())
            .then(data => {
                const contacEl = document.getElementById("contac");
                if (contacEl) contacEl.innerHTML = data;
            });

        function next_botton() {
            document.getElementById("costSection").style.display = "block";
        }

        function handleNext() {
            a = parseFloat(document.getElementById("road_dis").value);
            b = parseFloat(document.getElementById("road_width").value);
           
            gsb = parseFloat(document.getElementById("road_thickness_gsb").value);
            wet = parseFloat(document.getElementById("road_thickness_wet").value);
            bt = parseFloat(document.getElementById("road_thickness_bt").value);

            if (isNaN(a) || isNaN(b) || isNaN(gsb) || isNaN(wet) || isNaN(bt)) {
                alert("Please enter valid numeric values in all fields.");
                return false;
            }

            const container = document.querySelector(".container_cal");
            if (container) {
                container.style.display = "none";
            }
            next_botton();
        }

        function get_data() {
            const volumeFactor = (1000 * a * b) / 2.83;
            tg = volumeFactor * gsb;
            tw = volumeFactor * wet;
            tb = volumeFactor * bt;
            return true;
        }

        function cal_cost_stand_bt() {
            const tgc = tg * 1200;
            const twc = tw * 2000;
            const tbc = tb * 15000;
            const total = tgc + twc + tbc;
            showResult(tgc, twc, tbc, total);
        }

        function cal_cost_manual_bt() {
            const tgc = tg * man_gsb_cost;
            const twc = tw * man_wet_cost;
            const tbc = tb * man_bt_cost;
            const total = tgc + twc + tbc;
            showResult(tgc, twc, tbc, total);
        }

        function showResult(tgc, twc, tbc, total) {
            const resultEl = document.getElementById("cal_result");
            resultEl.style.display = "block";
            resultEl.innerHTML = `
                <p>GSB Material Volume: ${tg.toFixed(2)} m³</p>
                <p>Estimated cost of GSB material: ₹${tgc.toFixed(2)}</p>
                <p>Wet Mix Material Volume: ${tw.toFixed(2)} m³</p>
                <p>Estimated cost of Wet mix material: ₹${twc.toFixed(2)}</p>
                <p>B.T Layer Volume: ${tb.toFixed(2)} m³</p>
                <p>Estimated cost of B.T material: ₹${tbc.toFixed(2)}</p>
                <p><strong>Total Estimated Cost: ₹${total.toFixed(2)}</strong></p>
            `;
            document.getElementById("back_button_container").style.display = "block";
        }

        function checkSelection() {
            const msg = document.getElementById("message_area");
            msg.innerText = "";
            if (!get_data()) return;

            const options = document.getElementsByName("road_cost_Option");
            let selected = null;
            for (let i = 0; i < options.length; i++) {
                if (options[i].checked) {
                    selected = options[i].value;
                    break;
                }
            }

            const manualBox = document.getElementById("manualEstimationBox");
            if (selected === "manual") {
                manualBox.style.display = "block";
            } else if (selected === "market") {
                manualBox.style.display = "none";
                cal_cost_stand_bt();
            } else {
                msg.innerText = "Please select an option.";
                msg.style.color = "red";
            }
        }

        function manual_estimation() {
            man_gsb_cost = parseFloat(document.getElementById("gsb_mat").value);
            man_wet_cost = parseFloat(document.getElementById("wet_mat").value);
            man_bt_cost = parseFloat(document.getElementById("bt_mat").value);

            if (isNaN(man_gsb_cost) || isNaN(man_wet_cost) || isNaN(man_bt_cost)) {
                alert("Please enter valid numeric values in all fields.");
                return false;
            }

            cal_cost_manual_bt();
        }
    </script>
</head>
<body>
    <div id="home"></div>

    <div class="container_cal">
        <label>Enter the distance of the road in kms:</label>
        <input id="road_dis" type="number" step="0.1"><br>

        <label>Enter the width of the road in meters:</label>
        <input id="road_width" type="number" step="0.1"><br>

        
        <label>Enter the thickness of the GSB layer in milli meters:</label>
        <input id="road_thickness_gsb" type="number" step="0.01"><br>

        <label>Enter the thickness of the Wet Mix layer in milli meters:</label>
        <input id="road_thickness_wet" type="number" step="0.01"><br>

        <label>Enter the thickness of the B.T layer in milli meters:</label>
        <input id="road_thickness_bt" type="number" step="0.001"><br>

        <div class="cal_button2">
            <button class="action_seting_cal_2" onclick="handleNext()">Next</button>
            <button class="action_seting_cal_2" onclick="window.location.href='estimation of work.html'">Back to Selection</button>
        </div>
    </div>

    <div class="selection_type_cost" id="costSection" style="display: none;">
        <p>Select the type of estimation method for calculating the cost:</p>
        <label><input type="radio" name="road_cost_Option" value="market"> Estimate by market rate</label><br>
        <label><input type="radio" name="road_cost_Option" value="manual"> Estimate by user known rate</label><br><br>
        <button onclick="checkSelection()">Submit</button>
        <p id="message_area"></p>
    </div>

    <!-- Manual Rate Entry Section -->
    <div class="manual_estimation" id="manualEstimationBox" style="display: none;">
        <label>Enter the cost of GSB material per unit:</label>
        <input id="gsb_mat" type="number"><br>

        <label>Enter the cost of Wet Mix material per unit:</label>
        <input id="wet_mat" type="number" step="0.1"><br>

        <label>Enter the cost of B.T material per unit:</label>
        <input id="bt_mat" type="number" step="0.01"><br>

        <div style="display: flex; justify-content: center; align-items: center;">
            <button onclick="manual_estimation()" style="background-color: rgb(120, 241, 241);border-radius: 5px;" >Calculate</button>
        </div>
    </div>

    <!-- Result Box -->
    <div id="cal_result" class="reslt_calculation_2" style="display: none;"></div>

    <!-- Back Button -->
    <div id="back_button_container" style="display: none; text-align: center; margin-top: 20px;">
        <button class="action_seting_cal_2" onclick="window.location.href='estimation of work.html'">
            Back to Selection
        </button>
    </div>

    <div id="contac"></div>
</body>
</html>
